const q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}};q();document.querySelector(".submit-btn").addEventListener("click",b);const u=document.querySelector("form");u.setAttribute("novalidate",!0);let y,m=[],c=0,s=0;const L={companyUrl:"",company:"",mail:"",bytes:"",cleanerThan:"",gridCo2:"",renewCo2:"",lazyImg:"",respImg:"",optImg:"",optCode:"",hostNr:"",greenHost:!1,lazyLoading:!1};function b(){let e=document.querySelector('input[name="url"]'),t=document.querySelector('input[name="email"]');e.classList.remove("border-invalid"),t.classList.remove("border-invalid"),document.documentElement.style.setProperty("--focus-invalid","1.5px solid hotpink"),e.checkValidity()?t.checkValidity()?k():(document.querySelector(".email-invalid").animate(l,200),document.querySelector(".url-invalid").classList.add("hidden"),document.querySelector(".email-invalid").classList.remove("hidden"),t.classList.add("border-invalid"),console.log("url true, email false")):t.checkValidity()?(document.querySelector(".url-invalid").animate(l,200),document.querySelector(".url-invalid").classList.remove("hidden"),document.querySelector(".email-invalid").classList.add("hidden"),e.classList.add("border-invalid"),console.log("email true, url false")):(console.log("both false"),document.querySelector(".email-invalid").animate(l,200),document.querySelector(".url-invalid").animate(l,200),document.querySelector(".url-invalid").classList.remove("hidden"),document.querySelector(".email-invalid").classList.remove("hidden"),t.classList.add("border-invalid"),e.classList.add("border-invalid"))}function k(){console.log(u.elements.url.value),y=u.elements.url.value,document.querySelector("#form").classList.add("hidden"),document.querySelector("#form-container").classList.add("hidden"),document.querySelector("#loading-wrapper").classList.remove("hidden"),h(),x()}async function x(){const e="AIzaSyCv8E4cyKmeVNQtrLEnzrIMh9QnnOaKkT4",t=encodeURIComponent(y),o=`https://kea-alt-del.dk/websitecarbon/site/?url=${y}`,n=await(await fetch(`https://www.googleapis.com/pagespeedonline/v5/runPagespeed?url=${t}&key=${e}`)).json(),d=await(await fetch(o)).json();w(n,d)}function w(e,t){m.push(t),m.push(e.lighthouseResult.audits),console.log(m),z(m)}function z(e){const t=Object.create(L);t.company=u.elements.companyName.value,t.mail=u.elements.email.value,t.companyUrl=y,t.bytes=e[0].bytes;let o=e[0].cleanerThan;t.cleanerThan=o*100;let r=parseFloat(e[0].statistics.co2.grid.grams).toFixed(4);t.gridCo2=Number(r);let n=parseFloat(e[0].statistics.co2.renewable.grams).toFixed(4);t.renewCo2=Number(n),t.lazyImg=e[1]["offscreen-images"].details.overallSavingsBytes,t.respImg=e[1]["uses-responsive-images"].details.overallSavingsBytes;let a=e[1]["modern-image-formats"].details.overallSavingsBytes,d=e[1]["uses-optimized-images"].details.overallSavingsBytes;t.optImg=Math.round(a+d);let p=e[1]["unminified-css"].details.overallSavingsBytes,f=e[1]["unminified-javascript"].details.overallSavingsBytes,S=e[1]["unused-css-rules"].details.overallSavingsBytes,v=e[1]["unused-javascript"].details.overallSavingsBytes;return t.optCode=p+f+S+v,e[1]["lcp-lazy-loaded"].title.includes("not")?t.lazyLoading=!1:t.lazyLoading=!0,e[0].green?(t.greenHost=!0,t.hostNr=1):(t.greenHost=!1,t.hostNr=0),console.log(t),C(t),t}function C(e){document.querySelector("#page1").classList.add("hidden"),document.querySelector("#page2").classList.remove("hidden"),document.querySelector(".header-link").classList.remove("hidden"),I(e)}function I(e){console.log("res",e);let t=e.cleanerThan-90;console.log(t),document.documentElement.style.setProperty("--needle-position",`rotate(${t}deg)`),document.querySelector("#tick").classList.add("tick-animate"),document.querySelector("#url-name").textContent=e.company,e.cleanerThan>50?(document.querySelector("#cleaner-txt").classList.remove("hidden"),document.querySelector("#dirtier-txt").classList.add("hidden"),document.querySelector("#cleaner-nr").textContent=`${e.cleanerThan}%`):(document.querySelector("#dirtier-txt").classList.remove("hidden"),document.querySelector("#cleaner-txt").classList.add("hidden"),document.querySelector("#dirtier-nr").textContent=`${100-e.cleanerThan}%`),document.querySelector("#co2-nr").textContent=numeral(e.gridCo2).format("0,0.000"),e.greenHost?(document.querySelector("#green-host-container").classList.remove("hidden"),document.querySelector("#red-host-container").classList.add("hidden")):(document.querySelector("#green-host-container").classList.add("hidden"),document.querySelector("#red-host-container").classList.remove("hidden")),document.querySelector("#weight-nr").textContent=numeral(e.bytes).format("0,0"),N(e)}function N(e){let t=document.querySelector('input[type="range"]');t.max=e.optImg,t.value=e.optImg,document.querySelector("#max-value").textContent=`${numeral(e.optImg).format("0,0")} bytes`,e.greenHost&&document.querySelector("#green-host").setAttribute("checked",!0),e.lazyLoading?(document.querySelector("#lazy-load-container").classList.add("hidden"),document.querySelector("#opt-lazy-loading").classList.remove("hidden"),document.querySelector("#opt-lazy-nr").textContent=numeral(e.lazyImg).format("0,0")):(document.querySelector("#lazy-load-container").classList.remove("hidden"),document.querySelector("#opt-lazy-loading").classList.add("hidden"),document.querySelector("#lazy-nr").textContent=numeral(e.lazyImg).format("0,0")),document.querySelector("#resp-nr").textContent=numeral(e.respImg).format("0,0"),document.querySelector("#code-nr").textContent=numeral(e.optCode).format("0,0"),document.querySelector("#green-host").addEventListener("change",o=>{o.target.checked?(console.log("is checked"),e.greenHost=!0,i(e)):(console.log("is not checked"),e.greenHost=!1,i(e))}),document.querySelector("#lazy-loading").addEventListener("change",o=>{o.target.checked?(console.log("is checked"),c=c+++e.lazyImg,i(e)):(console.log("is not checked"),c=c---e.lazyImg,i(e))}),document.querySelector("#opt-lazy-loading").addEventListener("change",o=>{o.target.checked?(c=c+++e.lazyImg,console.log(c),i(e)):(console.log("is not checked"),c=c---e.lazyImg,i(e))}),document.querySelector("#resp-img-opt").addEventListener("change",o=>{o.target.checked?(console.log("is checked"),c=c+++e.respImg,i(e),console.log(c)):(c=c---e.respImg,console.log("is not checked"),i(e))}),document.querySelector("#code-opt").addEventListener("change",o=>{o.target.checked?(console.log("is checked"),c=c+++e.optCode,i(e)):(console.log("is not checked"),c=c---e.optCode,i(e))}),document.querySelector('input[type="range"]').addEventListener("change",o=>{let r=e.optImg-o.target.value;console.log("range input",r);const n=c+++r;console.log("newNr",n),T(e,n)})}function T(e,t){s=e.bytes-t,fetch(`https://kea-alt-del.dk/websitecarbon/data/?bytes=${s}&green=${e.hostNr}`).then(r=>r.json()).then(o);function o(r){g(e,r)}}function i(e){c>e.bytes?s=e.bytes:s=e.bytes-c,console.log(s),fetch(`https://kea-alt-del.dk/websitecarbon/data/?bytes=${s}&green=${e.hostNr}`).then(o=>o.json()).then(t);function t(o){g(e,o)}}function g(e,t){console.log(t);let o=t.cleanerThan*100,r=o-90;console.log(r),document.documentElement.style.setProperty("--needle-position",`rotate(${r}deg)`),document.querySelector("#tick").classList.add("tick-animate"),o>50?(document.querySelector("#cleaner-txt").animate(l,1e3),document.querySelector("#cleaner-txt").classList.remove("hidden"),document.querySelector("#dirtier-txt").classList.add("hidden"),document.querySelector("#cleaner-nr").textContent=`${numeral(o).format("0,0")}%`):(document.querySelector("#dirtier-txt").animate(l,1e3),document.querySelector("#dirtier-txt").classList.remove("hidden"),document.querySelector("#cleaner-txt").classList.add("hidden"),document.querySelector("#dirtier-nr").textContent=`${100-numeral(o).format("0,0")}%`),document.querySelector("#co2-nr").animate(l,1e3),document.querySelector("#co2-nr").textContent=numeral(t.statistics.co2.grid.grams).format("0,0.000"),e.greenHost?(console.log("is green",e.greenHost),document.querySelector("#green-container").animate(l,1e3),document.querySelector("#green-container").classList.remove("hidden"),document.querySelector("#red-host-container").classList.add("hidden")):(console.log("is not",e.greenHost),document.querySelector("#red-host-container").animate(l,1e3),document.querySelector("#green-container").classList.add("hidden"),document.querySelector("#red-host-container").classList.remove("hidden")),document.querySelector("#weight-nr").animate(l,1e3),document.querySelector("#weight-nr").textContent=numeral(s).format("0,0")}function h(){setTimeout($,1e3),setTimeout(E,4e3),setTimeout(H,8e3),console.log("now text appears")}function D(){h()}function $(){document.querySelector(".first-h3").classList.remove("hidden"),document.querySelector(".third-h3").classList.add("hidden")}function E(){document.querySelector(".sec-h3").classList.remove("hidden"),document.querySelector(".first-h3").classList.add("hidden")}function H(){document.querySelector(".third-h3").classList.remove("hidden"),document.querySelector(".first-h3").classList.add("hidden"),document.querySelector(".sec-h3").classList.add("hidden"),setTimeout(D,2e3)}const l=[{opacity:0},{opacity:1}];let R=document.querySelector("#page1");R.animate(l,1e3);var j=numeral(123456789).format("0,0");console.log("nr",j);
